# Google Document to Slide Generator

ğŸ“„ â†’ ğŸ¤– â†’ ğŸ¨

Google ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®å†…å®¹ã‚’ Vertex AI ã§è§£æã—ã€Google Slides ã‚’è‡ªå‹•ç”Ÿæˆã™ã‚‹ã‚¢ãƒ‰ã‚ªãƒ³ã§ã™ã€‚

## æ©Ÿèƒ½

| ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›® | èª¬æ˜ |
|-------------|------|
| **Create Template** | 5ã¤ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚’æŒã¤ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¹ãƒ©ã‚¤ãƒ‰ã‚’è‡ªå‹•ç”Ÿæˆ |
| **Convert to JSON** | ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ Vertex AI ã§è§£æã—ã€ã‚¹ãƒ©ã‚¤ãƒ‰ç”¨ JSON ã«å¤‰æ› |
| **Generate Slide** | JSON ã‚’åŸºã«ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‹ã‚‰ Google Slides ã‚’è‡ªå‹•ç”Ÿæˆ |

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  doc-to-slide-addon â”‚ â”€â”€â–¶ â”‚   slide-generator-api    â”‚
â”‚  (Google Docs Add-onâ”‚     â”‚   (GAS Library)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                            â”‚
         â–¼                            â–¼
   Vertex AI API              Google Slides API
```

**Cloud Functions ä¸è¦ï¼** GAS Library é€£æºã§ã‚·ãƒ³ãƒ—ãƒ«ãªã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’å®Ÿç¾ã€‚

## ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ— (Setup)

æœ¬ã‚¢ãƒ‰ã‚ªãƒ³ã‚’å‹•ä½œã•ã›ã‚‹ãŸã‚ã«å¿…è¦ãªã€è©³ç´°ãªç’°å¢ƒæ§‹ç¯‰æ‰‹é †ã§ã™ã€‚
Google Docs ã«ç´ä»˜ã„ãŸ GAS ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¨ã—ã¦ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã™ã‚‹ã“ã¨ã‚’æƒ³å®šã—ã¦ã„ã¾ã™ã€‚

### 0. å‰ææ¡ä»¶ (Prerequisites)
- **Google Workspace ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ**ï¼ˆæ¨å¥¨ï¼‰ã¾ãŸã¯å€‹äººã® Gmail ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ
- **Google Cloud Platform (GCP)** (è‡ªå‹•ç”Ÿæˆã®å ´åˆ)
    - â€» å®Œå…¨è‡ªå‹•ãƒ¢ãƒ¼ãƒ‰(è‡ªå‹•ç”Ÿæˆ)ã«ã¯ GCP ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¨èª²é‡‘è¨­å®šãŒå¿…è¦ã§ã™ã€‚
    - â€» **æ‰‹å‹•ãƒ¢ãƒ¼ãƒ‰ (Gem é€£æº)** ã§ã¯ GCP è¨­å®šã¯ä¸è¦ã§ã™ã€‚

### ãƒ¢ãƒ¼ãƒ‰é¸æŠ (Choose your mode)
æœ¬ã‚¢ãƒ‰ã‚ªãƒ³ã«ã¯2ã¤ã®ãƒ¢ãƒ¼ãƒ‰ãŒã‚ã‚Šã¾ã™ã€‚

- **Mode A: è‡ªå‹•ç”Ÿæˆãƒ¢ãƒ¼ãƒ‰ (Vertex AI)**
    - GCP Project ã®è¨­å®šãŒå¿…è¦ï¼ˆä¸­ç´šè€…ã€œå‘ã‘ï¼‰
    - ãƒœã‚¿ãƒ³ä¸€ã¤ã§ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆè§£æã‹ã‚‰ JSON ç”Ÿæˆã¾ã§å®Œäº†ã—ã¾ã™ã€‚

- **Mode B: æ‰‹å‹•ç”Ÿæˆãƒ¢ãƒ¼ãƒ‰ (Manual JSON / Gem)**
    - GCP è¨­å®šä¸è¦ï¼ˆåˆå¿ƒè€…å‘ã‘ï¼‰
    - ã‚«ã‚¹ã‚¿ãƒ  Gemï¼ˆãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆï¼‰ã«ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’èª­ã¾ã›ã€ç”Ÿæˆã•ã‚ŒãŸ JSON ã‚’æ‰‹å‹•ã§è²¼ã‚Šä»˜ã‘ã‚‹æ–¹å¼ã§ã™ã€‚

---

## ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é † (è‡ªå‹•ç”Ÿæˆãƒ¢ãƒ¼ãƒ‰)

### 1. GCP ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ
GAS æ¨™æº–ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ãªãã€æ©Ÿèƒ½åˆ¶é™ã®ãªã„ **Standard GCP Project** ã‚’ä½œæˆã—ã¾ã™ã€‚

1. [Google Cloud Console](https://console.cloud.google.com/) ã«ã‚¢ã‚¯ã‚»ã‚¹ã€‚
2. ã€Œ**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ**ã€ã‹ã‚‰æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆï¼ˆä¾‹: `slide-generator`ï¼‰ã€‚
3. **é‡è¦**: ä½œæˆã—ãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã« **èª²é‡‘ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ** ã‚’ç´ä»˜ã‘ã¾ã™ã€‚

### 2. å¿…è¦ãª API ã®æœ‰åŠ¹åŒ–
ä½œæˆã—ãŸ GCP ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã€ä»¥ä¸‹ã® API ã‚’æœ‰åŠ¹åŒ–ã—ã¦ãã ã•ã„ã€‚ã€Œ**API ã¨ã‚µãƒ¼ãƒ“ã‚¹ > ãƒ©ã‚¤ãƒ–ãƒ©ãƒª**ã€ã‹ã‚‰æ¤œç´¢ã§ãã¾ã™ã€‚

| API å | ç”¨é€” |
|--------|------|
| **Vertex AI API** | AI ã«ã‚ˆã‚‹ã‚¹ãƒ©ã‚¤ãƒ‰æ§‹æˆæ¡ˆï¼ˆJSONï¼‰ã®ç”Ÿæˆ |
| **Google Slides API** | ã‚¹ãƒ©ã‚¤ãƒ‰ã®ä½œæˆã€ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆæ“ä½œ |
| **Google Drive API** | ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚³ãƒ”ãƒ¼ã€ã‚¹ãƒ©ã‚¤ãƒ‰ã®ä¿å­˜ |

### 3. OAuth åŒæ„ç”»é¢ã®æ§‹æˆ
ã€Œ**API ã¨ã‚µãƒ¼ãƒ“ã‚¹ > OAuth åŒæ„ç”»é¢**ã€ã‚’è¨­å®šã—ã¾ã™ã€‚

1. **User Type**:
    - çµ„ç¹”å†…ã®ã¿ã§ä½¿ã†å ´åˆ: `å†…éƒ¨ (Internal)`
    - å€‹äººã®å ´åˆ: `å¤–éƒ¨ (External)`
2. ã‚¢ãƒ—ãƒªæƒ…å ±ï¼ˆåå‰ã€ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼‰ã‚’å…¥åŠ›ã—ã¦ä¿å­˜ã€‚
3. ï¼ˆExternal ã®å ´åˆã®ã¿ï¼‰**ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼** ã«è‡ªåˆ†ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’è¿½åŠ ã€‚

### 4. GAS ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¸ã®ç´ä»˜ã‘
Google Docs ã«ç´ä»˜ã GAS ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«å¯¾ã—ã€ä¸Šè¨˜ GCP ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’è¨­å®šã—ã¾ã™ã€‚

1. æœ¬ãƒªãƒã‚¸ãƒˆãƒªã® `apps/doc-to-slide-addon` ã‚’ã€Google Docs ã® Apps Script ã¨ã—ã¦ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆã¾ãŸã¯ `clasp push`ï¼‰ã—ã¾ã™ã€‚
2. GAS ã‚¨ãƒ‡ã‚£ã‚¿ã‚’é–‹ãã€å·¦å´ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®ã€Œ**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¨­å®š** (âš™ï¸)ã€ã‚’é–‹ãã¾ã™ã€‚
3. ã€Œ**Google Cloud Platform (GCP) ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ**ã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ã€Œ**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’å¤‰æ›´**ã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã€‚
4. GCP ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ç¢ºèªã§ãã‚‹ **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç•ªå· (Project Number)** ã‚’å…¥åŠ›ã—ã¦è¨­å®šã—ã¾ã™ã€‚
   - â€» ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ ID (æ–‡å­—åˆ—) ã§ã¯ãªãã€**æ•°å­—ã®ç•ªå·** ã§ã™ã€‚

### 5. ç’°å¢ƒå¤‰æ•°ã®è¨­å®š (Script Properties)
GAS ã‚¨ãƒ‡ã‚£ã‚¿ã®ã€Œ**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¨­å®š** > **ã‚¹ã‚¯ãƒªãƒ—ãƒˆ ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£**ã€ã¾ãŸã¯ã‚¢ãƒ‰ã‚ªãƒ³ã® `Settings` ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰è¨­å®šã—ã¾ã™ã€‚

| ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ | ãƒ¢ãƒ¼ãƒ‰ | èª¬æ˜ |
|------------|--------|------|
| `GCP_PROJECT_ID` | è‡ªå‹• | GCP ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã® **ID** (æ–‡å­—åˆ—) |
| `VERTEX_AI_LOCATION` | è‡ªå‹• | Vertex AI ã®ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆä¾‹: `asia-northeast1`ï¼‰ |
| `VERTEX_AI_MODEL` | è‡ªå‹• | ä½¿ç”¨ã™ã‚‹ãƒ¢ãƒ‡ãƒ«ï¼ˆä¾‹: `gemini-2.5-flash`ï¼‰ |
| `GEM_URL` | **æ‰‹å‹•** | JSONä½œæˆç”¨ã«ä½¿ç”¨ã™ã‚‹ Gem ã® URL |



## ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

1. **Slide Generator > Create Template** - ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç”Ÿæˆ
2. ç”Ÿæˆã•ã‚ŒãŸã‚¹ãƒ©ã‚¤ãƒ‰ã§ãƒ†ãƒ¼ãƒã‚’èª¿æ•´
3. **Slide Generator > Convert to JSON** - ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆè§£æ
4. **Slide Generator > Generate Slide** - ã‚¹ãƒ©ã‚¤ãƒ‰ç”Ÿæˆ

## å¯¾å¿œãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ

| ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆå | ç”¨é€” |
|-------------|------|
| `TITLE` | è¡¨ç´™ï¼ˆã‚¿ã‚¤ãƒˆãƒ«ï¼‹ã‚µãƒ–ã‚¿ã‚¤ãƒˆãƒ«ï¼‰ |
| `AGENDA` | ç›®æ¬¡ãƒ»ã‚¢ã‚¸ã‚§ãƒ³ãƒ€ |
| `CONTENT` | ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ |
| `SECTION` | ã‚»ã‚¯ã‚·ãƒ§ãƒ³åŒºåˆ‡ã‚Š |
| `CONCLUSION` | ã¾ã¨ã‚ |

## ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

```
apps/
â”œâ”€â”€ doc-to-slide-addon/   # Google Docs Add-on
â”‚   â”œâ”€â”€ src/Code.ts
â”‚   â””â”€â”€ src/appsscript.json
â””â”€â”€ slide-generator-api/  # Slide Generator Library
    â”œâ”€â”€ src/api.ts
    â””â”€â”€ src/domain/       # DDD Architecture
```

