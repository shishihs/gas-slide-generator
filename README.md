# Google Document to Slide Generator

ğŸ“„ â†’ ğŸ¤– â†’ ğŸ¨

Google ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®å†…å®¹ã‚’ Vertex AI ã§è§£æã—ã€Google Slides ã‚’è‡ªå‹•ç”Ÿæˆã™ã‚‹ã‚¢ãƒ‰ã‚ªãƒ³ã§ã™ã€‚

## æ©Ÿèƒ½

| ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›® | èª¬æ˜ |
|-------------|------|
| **Create Template** | 5ã¤ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚’æŒã¤ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¹ãƒ©ã‚¤ãƒ‰ã‚’è‡ªå‹•ç”Ÿæˆ |
| **Convert to JSON** | ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ Vertex AI ã§è§£æã—ã€ã‚¹ãƒ©ã‚¤ãƒ‰ç”¨ JSON ã«å¤‰æ› |
| **Generate Slide** | JSON ã‚’åŸºã«ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‹ã‚‰ Google Slides ã‚’è‡ªå‹•ç”Ÿæˆ |

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  doc-to-slide-addon â”‚ â”€â”€â–¶ â”‚   slide-generator-api    â”‚
â”‚  (Google Docs Add-onâ”‚     â”‚   (GAS Library)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                            â”‚
         â–¼                            â–¼
   Vertex AI API              Google Slides API
```

**Cloud Functions ä¸è¦ï¼** GAS Library é€£æºã§ã‚·ãƒ³ãƒ—ãƒ«ãªã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’å®Ÿç¾ã€‚

## ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ— & ãƒ‡ãƒ—ãƒ­ã‚¤ (Setup & Deploy)

æœ¬ã‚·ã‚¹ãƒ†ãƒ ã¯ **2ã¤ã® GAS ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ** (ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç”¨ã€ã‚¢ãƒ‰ã‚ªãƒ³ç”¨) ã¨ **1ã¤ã® GCP ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ** ã§æ§‹æˆã•ã‚Œã¦ã„ã¾ã™ã€‚
ä»¥ä¸‹ã®æ‰‹é †é€šã‚Šã«ä½œæ¥­ã‚’é€²ã‚ã¦ãã ã•ã„ã€‚

### 0. é–‹ç™ºç’°å¢ƒã®æº–å‚™ (Prerequisites)

ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ã‚³ãƒ¼ãƒ‰ã‚’ãƒ“ãƒ«ãƒ‰ãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ãŸã‚ã«å¿…è¦ã§ã™ã€‚

1. **Node.js**: v18ä»¥ä¸Šã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
2. **ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«**:
   ```bash
   npm install
   ```
3. **Clasp (GAS CLI) ã¸ã®ãƒ­ã‚°ã‚¤ãƒ³**:
   ```bash
   npx clasp login
   ```
   â€» ãƒ–ãƒ©ã‚¦ã‚¶ãŒé–‹ãã®ã§ã€Google ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§è¨±å¯ã—ã¦ãã ã•ã„ã€‚

---

### 1. Slide Generator API (ãƒ©ã‚¤ãƒ–ãƒ©ãƒª) ã®ãƒ‡ãƒ—ãƒ­ã‚¤

ã‚¹ãƒ©ã‚¤ãƒ‰ç”Ÿæˆã®ã‚³ã‚¢ãƒ­ã‚¸ãƒƒã‚¯ã‚’æ‹…å½“ã™ã‚‹ GAS ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¾ã™ã€‚

1. **ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªç§»å‹•**:
   ```bash
   cd apps/slide-generator-api
   ```

2. **GAS ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ**:
   ```bash
   npx clasp create --type standalone --title "Slide Generator API" --rootDir dist
   ```

3. **ãƒ“ãƒ«ãƒ‰ & ãƒ‡ãƒ—ãƒ­ã‚¤**:
   ```bash
   npm run deploy
   ```

4. **[é‡è¦] ãƒ©ã‚¤ãƒ–ãƒ©ãƒª ID ã®å–å¾—**:
   - `npx clasp open` ã§ GAS ã‚¨ãƒ‡ã‚£ã‚¿ã‚’é–‹ãã¾ã™ã€‚
   - å³ä¸Šã®ã€Œ**ãƒ‡ãƒ—ãƒ­ã‚¤**ã€ãƒœã‚¿ãƒ³ > ã€Œ**æ–°ã—ã„ãƒ‡ãƒ—ãƒ­ã‚¤**ã€ã‚’é¸æŠã€‚
   - ç¨®é¡ã®é¸æŠã§ã€Œ**ãƒ©ã‚¤ãƒ–ãƒ©ãƒª**ã€ã‚’é¸ã³ã€èª¬æ˜ã‚’å…¥åŠ›ã—ã¦ã€Œãƒ‡ãƒ—ãƒ­ã‚¤ã€ã€‚
   - ãƒ‡ãƒ—ãƒ­ã‚¤ã®ç”»é¢ï¼ˆã¾ãŸã¯ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¨­å®š âš™ï¸ï¼‰ã‹ã‚‰ **ã‚¹ã‚¯ãƒªãƒ—ãƒˆ ID** (Script ID) ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦æ§ãˆã¦ãã ã•ã„ã€‚

---

### 2. Doc to Slide Add-on (ã‚¢ãƒ‰ã‚ªãƒ³) ã®ãƒ‡ãƒ—ãƒ­ã‚¤

Google ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä¸Šã§å‹•ãã‚¢ãƒ‰ã‚ªãƒ³æœ¬ä½“ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¾ã™ã€‚

1. **ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªç§»å‹•**:
   ```bash
   cd ../doc-to-slide-addon
   ```

2. **ä¾å­˜ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®è¨­å®šæ›´æ–°**:
   `src/appsscript.json` ã‚’é–‹ãã€`dependencies.libraries` å†…ã® `libraryId` ã‚’ã€**æ‰‹é † 1-4 ã§å–å¾—ã—ãŸã‚¹ã‚¯ãƒªãƒ—ãƒˆ ID** ã«æ›¸ãæ›ãˆã¦ãã ã•ã„ã€‚
   ```json
   "libraries": [{
     "userSymbol": "SlideGeneratorApi",
     "libraryId": "YOUR_SCRIPT_ID_HERE",
     "version": "1", // ãƒ‡ãƒ—ãƒ­ã‚¤ã—ãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³
     "developmentMode": true // é–‹ç™ºä¸­ã¯ true
   }]
   ```

3. **GAS ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ**:
   ```bash
   npx clasp create --type docs --title "Doc to Slide Add-on" --rootDir src
   ```
   â€» ã‚³ãƒãƒ³ãƒ‰å®Œäº†å¾Œã«è¡¨ç¤ºã•ã‚Œã‚‹ URL ãŒã€ã‚¢ãƒ‰ã‚ªãƒ³ãŒç´ä»˜ã„ãŸ Google ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ãªã‚Šã¾ã™ã€‚

4. **ã‚³ãƒ¼ãƒ‰ã®ãƒ—ãƒƒã‚·ãƒ¥**:
   ```bash
   npx clasp push
   ```

---

### 3. GCP ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆã¨è¨­å®š

Vertex AI ã«ã‚ˆã‚‹è‡ªå‹•ç”Ÿæˆæ©Ÿèƒ½ã‚’ä½¿ã†ãŸã‚ã«å¿…é ˆã§ã™ã€‚

#### 3.1 GCP ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ
1. [Google Cloud Console](https://console.cloud.google.com/) ã«ã‚¢ã‚¯ã‚»ã‚¹ã€‚
2. ã€Œ**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ**ã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€ä»»æ„ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåï¼ˆä¾‹: `slide-generator`ï¼‰ã§ä½œæˆã€‚
3. **é‡è¦**: ä½œæˆã—ãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã« **èª²é‡‘ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ** ã‚’ç´ä»˜ã‘ã¾ã™ï¼ˆVertex AI ã®åˆ©ç”¨ã«å¿…è¦ï¼‰ã€‚

#### 3.2 API ã®æœ‰åŠ¹åŒ–
ä½œæˆã—ãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã€Œ**API ã¨ã‚µãƒ¼ãƒ“ã‚¹ > æœ‰åŠ¹ãª API ã¨ã‚µãƒ¼ãƒ“ã‚¹ > API ã®æœ‰åŠ¹åŒ–**ã€ã¸ç§»å‹•ã—ã€ä»¥ä¸‹ã‚’æ¤œç´¢ã—ã¦æœ‰åŠ¹ã«ã—ã¾ã™ã€‚

- **Vertex AI API**
- **Google Slides API**
- **Google Drive API**

#### 3.3 OAuth åŒæ„ç”»é¢ã®è¨­å®š
ã€Œ**API ã¨ã‚µãƒ¼ãƒ“ã‚¹ > OAuth åŒæ„ç”»é¢**ã€ã‹ã‚‰è¨­å®šã—ã¾ã™ã€‚

1. **User Type**: `å¤–éƒ¨ (External)` ã‚’é¸æŠï¼ˆçµ„ç¹”å†…ã®ã¿ãªã‚‰ Internal ã§ã‚‚å¯ï¼‰ã€‚
2. ã‚¢ãƒ—ãƒªæƒ…å ±ï¼ˆåå‰: `Slide Generator` ç­‰ã€ãƒ¡ã‚¢ãƒ‰ï¼‰ã‚’å…¥åŠ›ã—ã¦ä¿å­˜ã€‚
3. **ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼**: è‡ªåˆ†ã® Google ã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼ˆãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼‰ã‚’è¿½åŠ ã—ã¾ã™ã€‚

---

### 4. GAS ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¨ GCP ã®ç´ä»˜ã‘

æœ€å¾Œã«ã€GAS (ã‚¢ãƒ‰ã‚ªãƒ³å´) ãŒ GCP ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’ä½¿ãˆã‚‹ã‚ˆã†ã«ãƒªãƒ³ã‚¯ã—ã¾ã™ã€‚

1. **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç•ªå·ã®ç¢ºèª**:
   - GCP ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã®ãƒˆãƒƒãƒ—ï¼ˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼‰ã§ **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç•ªå· (Project Number)**ï¼ˆä¾‹: `123456789012`ï¼‰ã‚’ç¢ºèªã—ã¾ã™ã€‚ï¼ˆâ€» ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ ID ã§ã¯ã‚ã‚Šã¾ã›ã‚“ï¼‰

2. **GAS è¨­å®šã®å¤‰æ›´**:
   - `apps/doc-to-slide-addon` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§ `npx clasp open` ã‚’å®Ÿè¡Œã—ã€ã‚¢ãƒ‰ã‚ªãƒ³ã® GAS ã‚¨ãƒ‡ã‚£ã‚¿ã‚’é–‹ãã¾ã™ã€‚
   - å·¦å´ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®ã€Œ**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¨­å®š (âš™ï¸)**ã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã€‚
   - ã€Œ**Google Cloud Platform (GCP) ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ**ã€æ¬„ã®ã€Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’å¤‰æ›´ã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã€‚
   - å…ˆã»ã©ã® **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç•ªå·** ã‚’å…¥åŠ›ã—ã¦è¨­å®šã—ã¾ã™ã€‚

### 5. ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®è¨­å®š

GAS ã‚¨ãƒ‡ã‚£ã‚¿ã®ã€Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¨­å®šã€æœ€ä¸‹éƒ¨ã«ã‚ã‚‹ã€Œ**ã‚¹ã‚¯ãƒªãƒ—ãƒˆ ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£**ã€ã‚’è¿½åŠ ã—ã¾ã™ã€‚

| ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ | è¨­å®šå€¤ |
|------------|--------|
| `GCP_PROJECT_ID` | ä½œæˆã—ãŸ GCP ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã® **ID** (æ–‡å­—åˆ—) |
| `VERTEX_AI_LOCATION` | `asia-northeast1` (ã¾ãŸã¯ä»»æ„ã®ãƒªãƒ¼ã‚¸ãƒ§ãƒ³) |
| `VERTEX_AI_MODEL` | `gemini-2.0-flash-exp` (ã¾ãŸã¯ `gemini-1.5-pro` ç­‰) |
| `GEM_URL` | (æ‰‹å‹•ãƒ¢ãƒ¼ãƒ‰ç”¨) Gem ã® URL |

---



## ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

1. **Slide Generator > Create Template** - ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç”Ÿæˆ
2. ç”Ÿæˆã•ã‚ŒãŸã‚¹ãƒ©ã‚¤ãƒ‰ã§ãƒ†ãƒ¼ãƒã‚’èª¿æ•´
3. **Slide Generator > Convert to JSON** - ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆè§£æ
4. **Slide Generator > Generate Slide** - ã‚¹ãƒ©ã‚¤ãƒ‰ç”Ÿæˆ

## å¯¾å¿œãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ

| ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆå | ç”¨é€” |
|-------------|------|
| `TITLE` | è¡¨ç´™ï¼ˆã‚¿ã‚¤ãƒˆãƒ«ï¼‹ã‚µãƒ–ã‚¿ã‚¤ãƒˆãƒ«ï¼‰ |
| `AGENDA` | ç›®æ¬¡ãƒ»ã‚¢ã‚¸ã‚§ãƒ³ãƒ€ |
| `CONTENT` | ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ |
| `SECTION` | ã‚»ã‚¯ã‚·ãƒ§ãƒ³åŒºåˆ‡ã‚Š |
| `CONCLUSION` | ã¾ã¨ã‚ |

## ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

```
apps/
â”œâ”€â”€ doc-to-slide-addon/   # Google Docs Add-on
â”‚   â”œâ”€â”€ src/Code.ts
â”‚   â””â”€â”€ src/appsscript.json
â””â”€â”€ slide-generator-api/  # Slide Generator Library
    â”œâ”€â”€ src/api.ts
    â””â”€â”€ src/domain/       # DDD Architecture
```

