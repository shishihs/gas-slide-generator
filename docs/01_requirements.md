# 要件定義書 - Google Document to Slide Generator

## 1. プロジェクト概要
Google ドキュメントの内容を AI (Vertex AI) で解析・構造化し、その構造化データを基に Google Slides を自動生成する Google Workspace アドオン。

## 2. ユーザーストーリー
- **ユーザー**は、Google ドキュメントで議事録や原稿を作成した後、ワンクリックでプレゼンテーション用スライドの下書きを作成したい。
- **ユーザー**は、スライド化する前に AI が抽出した構成（JSON）を確認・修正したい（将来的な拡張）。
- **ユーザー**は、社内のデザインテンプレートに則ったスライドを生成したい。

## 3. 機能要件

### 3.1. メニュー統合
- Google ドキュメントを開いた際、アドオンメニュー「Slide Generator」が自動的に追加されること。
- メニューには以下の項目が含まれること：
    - `Convert to JSON`: ドキュメント解析・JSON変換
    - `Generate Slide`: スライド生成サイドバーの表示
    - `Settings`: 設定サイドバーの表示

### 3.2. ドキュメント解析 (Convert to JSON)
- 現在開いているドキュメントの本文テキストを取得できること。
- 取得したテキストを Vertex AI (Gemini モデル) に送信し、スライド構成用の JSON データに変換できること。
- 生成された JSON データをドキュメントのプロパティ（または一時領域）に保存できること。

### 3.3. スライド生成 (Generate Slide)
- サイドバー等の UI を通じてスライド生成を実行できること。
- 指定された Google Slides テンプレートをコピーして新規プレゼンテーションを作成できること。
- 保存された JSON データに基づき、スライドのページ（タイトル、箇条書き、セクション区切り等）を編集・追加できること。
- 生成完了後、ユーザーに生成されたスライドの URL を提示すること。

### 3.4. 設定管理 (Settings)
- 以下の設定値をユーザー（または管理者）が GUI で設定・保存できること：
    - **GCP Project ID**: Vertex AI を利用する Google Cloud プロジェクト ID
    - **Location**: リージョン (例: `asia-northeast1`)
    - **Model**: 使用する Gemini モデル (例: `gemini-1.5-flash`)
    - **Template Slide ID**: コピー元のスライドテンプレート ID

## 4. 非機能要件

### 4.1. セキュリティ & 認証
- **Google OAuth**: ユーザーの Google アカウント権限（OAuth 2.0）を利用して認証を行うこと。
- **IAM**: Vertex AI へのアクセスは、GCP プロジェクトの IAM ポリシーで制御されること（サービスアカウントキー埋め込み等は行わない）。
- **データプライバシー**: ドキュメントの内容は AI 解析のみに使用し、外部の永続ストレージ（ログ等）には保存しないこと。

### 4.2. パフォーマンス
- Vertex AI からのレスポンス待ち時間中、タイムアウトしないような設計（またはユーザーへのローディング表示）を行うこと。
- GAS の実行時間制限（6分/30分）を考慮した処理分割（必要であれば）。

### 4.3. ユーザビリティ
- 処理状況（ロード中、成功、エラー）をサイドバーやポップアップで明確にユーザーにフィードバックすること。

## 5. 制約事項
- Google Apps Script (GAS) 環境で動作すること。
- Vertex AI API が有効化された GCP プロジェクトが必要。
- ユーザーは対象の GCP プロジェクトに対して `vertexai.user` 相当の権限を持っている必要がある。
