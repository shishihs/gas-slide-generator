# Google Document to Slide Generator

Google ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®å†…å®¹ã‚’ Vertex AI ã‚’ä½¿ã£ã¦ JSON å½¢å¼ã«å¤‰æ›ã—ã€Google Slides ã‚’è‡ªå‹•ç”Ÿæˆã™ã‚‹ã‚¢ãƒ‰ã‚ªãƒ³ã§ã™ã€‚

## ğŸ“‹ æ¦‚è¦

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ä»¥ä¸‹ã®æ©Ÿèƒ½ã‚’æä¾›ã—ã¾ã™ï¼š

1. **Convert to JSON**: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®å†…å®¹ã‚’ Vertex AI ã‚’ä½¿ã£ã¦æ§‹é€ åŒ–ã•ã‚ŒãŸ JSON ã«å¤‰æ›
2. **Generate Slide**: JSON ã‚’åŸºã«ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‹ã‚‰ Google Slides ã‚’è‡ªå‹•ç”Ÿæˆ

## ğŸ—ï¸ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

**ã‚·ãƒ³ãƒ—ãƒ«ãªæ§‹æˆ - Cloud Functions ä¸è¦ï¼**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Google Document                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  GAS ã‚¢ãƒ‰ã‚ªãƒ³                                                    â”‚â”‚
â”‚  â”‚  - Custom Menu: [Convert to JSON] [Generate Slide]              â”‚â”‚
â”‚  â”‚  - Sidebar UI for interaction                                   â”‚â”‚
â”‚  â”‚  - ScriptApp.getOAuthToken() ã§èªè¨¼                             â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚ HTTPS + OAuth Token
                               â”‚ (ç›´æ¥å‘¼ã³å‡ºã—)
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Vertex AI (Gemini)                                                  â”‚
â”‚  - ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆè§£æ                                                   â”‚
â”‚  - ã‚¹ãƒ©ã‚¤ãƒ‰ç”¨ JSON ç”Ÿæˆ                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ãªãœ Cloud Functions ãŒä¸è¦ã‹ï¼Ÿ

- Vertex AI ã¯ Google ã®ã‚µãƒ¼ãƒ“ã‚¹ãªã®ã§ã€IP åˆ¶é™ãŒãªã„
- GAS ã¯ `ScriptApp.getOAuthToken()` ã§ Google OAuth ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—ã§ãã‚‹
- ã“ã®ãƒˆãƒ¼ã‚¯ãƒ³ã§ Vertex AI REST API ã‚’ç›´æ¥å‘¼ã³å‡ºã—å¯èƒ½
- â†’ **Proxy ã‚µãƒ¼ãƒãƒ¼ï¼ˆCloud Functionsï¼‰ã¯ä¸è¦ï¼**

## ğŸ“ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

```
gas-slide-generator/
â”œâ”€â”€ README.md
â”œâ”€â”€ docs/
â”‚   â””â”€â”€ README.md       # ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«
â””â”€â”€ apps/
    â””â”€â”€ gas-addon/      # Google Apps Script ã‚¢ãƒ‰ã‚ªãƒ³
        â”œâ”€â”€ Code.js                    # ãƒ¡ã‚¤ãƒ³ãƒ­ã‚¸ãƒƒã‚¯
        â”œâ”€â”€ GenerateSlideSidebar.html  # ã‚¹ãƒ©ã‚¤ãƒ‰ç”Ÿæˆã‚µã‚¤ãƒ‰ãƒãƒ¼
        â”œâ”€â”€ SettingsSidebar.html       # è¨­å®šã‚µã‚¤ãƒ‰ãƒãƒ¼
        â”œâ”€â”€ appsscript.json            # GAS ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆ
        â””â”€â”€ .clasp.json                # clasp è¨­å®š
```

## ğŸš€ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### 1. GCP ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®š

```bash
# Vertex AI API ã‚’æœ‰åŠ¹åŒ–
gcloud services enable aiplatform.googleapis.com
```

### 2. GAS ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ GCP ã«ãƒªãƒ³ã‚¯

1. GAS ã‚¨ãƒ‡ã‚£ã‚¿ã§ã€Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¨­å®šã€ã‚’é–‹ã
2. ã€ŒGoogle Cloud Platform (GCP) ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç•ªå·ã‚’è¨­å®š

### 3. GAS ã‚¢ãƒ‰ã‚ªãƒ³ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤

```bash
cd apps/gas-addon
clasp push
```

### 4. è¨­å®š

1. Google ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’é–‹ã
2. ãƒ¡ãƒ‹ãƒ¥ãƒ¼: `Slide Generator` â†’ `Settings`
3. ä»¥ä¸‹ã‚’è¨­å®š:
   - **GCP Project ID**: Vertex AI APIãŒæœ‰åŠ¹ãªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆID
   - **Vertex AI Location**: `asia-northeast1` (Tokyo) ãªã©
   - **AI Model**: `gemini-1.5-flash` ãªã©
   - **Template Slide ID**: ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆSlideã®ID

## ğŸ“– ä½¿ã„æ–¹

1. Google ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«å¤‰æ›ã—ãŸã„å†…å®¹ã‚’æ›¸ã
2. ãƒ¡ãƒ‹ãƒ¥ãƒ¼: `Slide Generator` â†’ `Convert to JSON`
3. Vertex AI ãŒãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’è§£æã—ã€JSON ã«å¤‰æ›
4. ãƒ¡ãƒ‹ãƒ¥ãƒ¼: `Slide Generator` â†’ `Generate Slide`
5. ã‚µã‚¤ãƒ‰ãƒãƒ¼ã§ã€ŒGenerate Slidesã€ã‚’ã‚¯ãƒªãƒƒã‚¯
6. ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ã‚³ãƒ”ãƒ¼ã—ã¦æ–°ã—ã„ã‚¹ãƒ©ã‚¤ãƒ‰ãŒç”Ÿæˆã•ã‚Œã‚‹

## ğŸ”§ æŠ€è¡“çš„ãªå‚è€ƒãƒ‘ã‚¿ãƒ¼ãƒ³

### 1. ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¿½åŠ ãƒ‘ã‚¿ãƒ¼ãƒ³

```javascript
function onOpen() {
  DocumentApp.getUi()
    .createMenu('Slide Generator')
    .addItem('Convert to JSON', 'convertDocumentToJson')
    .addToUi();
}
```

### 2. ã‚µã‚¤ãƒ‰ãƒãƒ¼è¡¨ç¤ºãƒ‘ã‚¿ãƒ¼ãƒ³

```javascript
function showSidebar() {
  const html = HtmlService.createHtmlOutputFromFile('Sidebar')
    .setTitle('Title');
  DocumentApp.getUi().showSidebar(html);
}
```

### 3. Vertex AI ç›´æ¥å‘¼ã³å‡ºã—ãƒ‘ã‚¿ãƒ¼ãƒ³

```javascript
function callVertexAI(content) {
  const token = ScriptApp.getOAuthToken();
  const endpoint = `https://${location}-aiplatform.googleapis.com/v1/projects/${projectId}/locations/${location}/publishers/google/models/${model}:generateContent`;
  
  const response = UrlFetchApp.fetch(endpoint, {
    method: 'post',
    headers: { 'Authorization': `Bearer ${token}` },
    contentType: 'application/json',
    payload: JSON.stringify({ contents: [{ role: 'user', parts: [{ text: prompt }] }] })
  });
  
  return JSON.parse(response.getContentText());
}
```

## ğŸ“ é–‹ç™ºçŠ¶æ³

- [x] ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
- [x] ã‚·ãƒ³ãƒ—ãƒ«ãªæ§‹æˆï¼ˆCloud Functions ä¸è¦ï¼‰
- [x] åŸºæœ¬çš„ãª GAS ã‚¢ãƒ‰ã‚ªãƒ³æ§‹é€ 
- [x] ã‚µã‚¤ãƒ‰ãƒãƒ¼ UI
- [x] Vertex AI ç›´æ¥å‘¼ã³å‡ºã—
- [ ] ã‚¹ãƒ©ã‚¤ãƒ‰ç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯ã®å®Ÿè£…
- [ ] ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç®¡ç†æ©Ÿèƒ½
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å¼·åŒ–
- [ ] ãƒ†ã‚¹ãƒˆ

## ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

Private
